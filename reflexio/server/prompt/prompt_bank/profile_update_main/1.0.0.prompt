[Instructions start]
Given profile content definition, metadata definition, existing profiles and new interactions from previous messages, determine and extract profile updates from interactions based on the following three steps:
Step 1:
Determine if there is any new profile can be added or existing profile can be deleted or updated based on the user profile content definition and metadata definition from interactions. If there is no update, output an empty dictionary `{{}}` and stop.

Step 2:
If there is any user profile and metadata can be extracted/updated from the interactions, extract user profile content and corresponding metadata from the interactions following the definitions.
There are 4 types of updates:
1. Add a new profile: add a new profile if the new interaction that matches the profile content definition and previous does not exist.
2. Delete an existing profile: delete an existing profile if the new interaction indicate existing profile should be removed or outdated.
3. Edit an existing profile: delete an existing profile and add updated version of the profile if the new interaction indicate contradictions (delete the old one and add new one) or contains more information so existing profiles need to be updated (delete old one and add modified one).
4. Mention an existing profile: mention an existing profile if the new interaction contains information that is already in the existing profile.
Generate add, delete and mention fields in the json output.

Step 3:
If there is any new profile added, extract metadata based on definition for each profile extracted, and determine the time to live for the new profile considering the following:
- If the new profile is about user's preferences, such as food preferences, button clicks preference, view habits, etc, the time to live should be short, e.g. one_week, one_month, one_quarter, one_year. depending if the action is seasonal or not and its natural repeat frequency.
- If the new profile is about user's information, such as name, age, phone number, gender, etc, the time to live should be long, e.g. infinity.
[Instructions end]

[Context start]
Existing profiles: [{existing_profiles}]
[Context end]

[Definitions start]
User profile content definition: {profile_content_definition_prompt}

metadata definition: {metadata_definition_prompt}

Remember only extract profile and metadata based on above definitions.
[Definitions end]

[Interaction start]
User and agent interactions:
{interactions}
[Interaction end]

[Examples start]
1. Add a new profile with time to live that is not in the existing profiles:
User profile content definition: "food preferences"
User profile metadata definition: "choose cuisine type from the following: pizza, sushi, pasta, salad, steak"
User interactions: "i like to eat pizza"
Output:
```json
{{
    "add": [{{
        "content": "i like to eat pizza",
        "time_to_live": "one_month",
        "metadata": "pizza"
    }}],
}}
```

2. Add a new profile with time to live that is in the existing profiles:
User interactions: "my name is John"
Output:
```json
{{
    "add": [{{
        "content": "name is John",
        "time_to_live": "infinity"
    }}],
}}
```

3. Delete an existing profile:
Existing profiles: " i like to eat pizza"
User interactions: "i don't like to eat pizza anymore"
Output:
```json
{{
    "delete": ["i like to eat pizza"],
}}
```

4. Edit an existing profile:
Existing profiles: "user prefer a concise answer"
User interactions: "i like concise answer with examples"
Output:
```json
{{
    "delete": ["user prefer a concise answer"],
    "add": ["user prefer concise answer with examples"],
}}
```

5. Mention an existing profile:
Existing profiles: " like to eat pizza"
User interactions: "order pizza again"
Output:
```json
{{
    "mention": ["like to eat pizza"],
}}
```
[Examples end]

[Output format]
Follow the examples above, generate updates in following json format:
```json
{{
    "add": [{{
        "content": "profile 1 content based on content definition",
        "time_to_live": "one_week",
        "metadata": "meta data extracted for profile 1 based on metadata definition"
    }}, {{
        "content": "profile 2 content based on content definition",
        "time_to_live": "one_month",
        "metadata": "meta data extracted for profile 2 based on metadata definition"
    }}],
    "delete": ["profile 3"],
    "mention": ["like to eat pizza"]
}}
```
