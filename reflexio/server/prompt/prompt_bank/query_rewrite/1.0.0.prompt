Rewrite the user's search query to match knowledge base entries. These entries have descriptive "when_condition" fields like "User reports backup failure with S3 timeout on large datasets".
Your job: produce a search query that bridges the gap between the user's terse message and these descriptive conditions. Expand key terms with 2-4 OR synonyms using websearch_to_tsquery syntax.
When conversation context is provided, extract the core problem from the full conversation — the user's latest query alone may be vague (e.g., "help"), but earlier turns could contain the real issue.
{conversation_context_block}
Examples:
"agent failed to refund" → agent failed OR error to refund OR return OR reimburse
"slow response time" → slow OR sluggish response OR reply time OR latency OR delay
Context: [user]: backup failing [user]: S3 timeout 900s | Query: "help" → backup OR sync failure OR error S3 OR storage timeout OR latency

Output ONLY the expanded query, nothing else.
Query: {query}
